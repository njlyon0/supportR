<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Publication-Quality Principal Coordinates Analysis (PCoA) Ordinations — pcoa_ord • supportR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Publication-Quality Principal Coordinates Analysis (PCoA) Ordinations — pcoa_ord"><meta name="description" content="
This function has been superseded by ordination because this is just a special case of that function. Additionally, ordination provides users much more control over the internal graphics functions used to create the fundamental elements of the graph
Produces Principal Coordinates Analysis (PCoA) ordinations for up to 10 groups. Assigns a unique color for each group and draws an ellipse around the standard deviation of the points. Automatically adds percent of variation explained by first two principal component axes parenthetically to axis labels. Because there are only five hollow shapes (see ?graphics::pch) all shapes are re-used a maximum of 2 times when more than 5 groups are supplied."><meta property="og:description" content="
This function has been superseded by ordination because this is just a special case of that function. Additionally, ordination provides users much more control over the internal graphics functions used to create the fundamental elements of the graph
Produces Principal Coordinates Analysis (PCoA) ordinations for up to 10 groups. Assigns a unique color for each group and draws an ellipse around the standard deviation of the points. Automatically adds percent of variation explained by first two principal component axes parenthetically to axis labels. Because there are only five hollow shapes (see ?graphics::pch) all shapes are re-used a maximum of 2 times when more than 5 groups are supplied."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">supportR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/supportr_01_wrangle.html">Data Wrangling</a></li>
    <li><a class="dropdown-item" href="../articles/supportr_02_quality-control.html">Quality Control</a></li>
    <li><a class="dropdown-item" href="../articles/supportr_03_visualizations.html">Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/supportr_04_outside-of-r.html">Operating Outside of R</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/njlyon0/supportR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Publication-Quality Principal Coordinates Analysis (PCoA) Ordinations</h1>
      <small class="dont-index">Source: <a href="https://github.com/njlyon0/supportR/blob/main/R/pcoa_ord.R" class="external-link"><code>R/pcoa_ord.R</code></a></small>
      <div class="d-none name"><code>pcoa_ord.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#superseded" class="external-link"><img src="figures/lifecycle-superseded.svg" alt="[Superseded]"></a></p>
<p>This function has been superseded by <code>ordination</code> because this is just a special case of that function. Additionally, <code>ordination</code> provides users much more control over the internal <code>graphics</code> functions used to create the fundamental elements of the graph</p>
<p>Produces Principal Coordinates Analysis (PCoA) ordinations for up to 10 groups. Assigns a unique color for each group and draws an ellipse around the standard deviation of the points. Automatically adds percent of variation explained by first two principal component axes parenthetically to axis labels. Because there are only five hollow shapes (see <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">?graphics::pch</a></code>) all shapes are re-used a maximum of 2 times when more than 5 groups are supplied.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pcoa_ord</span><span class="op">(</span></span>
<span>  mod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  groupcol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#41b6c4"</span>, <span class="st">"#c51b7d"</span>, <span class="st">"#7fbc41"</span>, <span class="st">"#d73027"</span>, <span class="st">"#4575b4"</span>, <span class="st">"#e08214"</span>, <span class="st">"#8073ac"</span>,</span>
<span>    <span class="st">"#f1b6da"</span>, <span class="st">"#b8e186"</span>, <span class="st">"#8c96c6"</span><span class="op">)</span>,</span>
<span>  shapes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">21</span><span class="op">:</span><span class="fl">25</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, times <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  pt_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lab_text_size <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>  axis_text_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  leg_pos <span class="op">=</span> <span class="st">"bottomleft"</span>,</span>
<span>  leg_cont <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">groupcol</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mod">mod<a class="anchor" aria-label="anchor" href="#arg-mod"></a></dt>
<dd><p>(pcoa) object returned by <code><a href="https://rdrr.io/pkg/ape/man/pcoa.html" class="external-link">ape::pcoa</a></code></p></dd>


<dt id="arg-groupcol">groupcol<a class="anchor" aria-label="anchor" href="#arg-groupcol"></a></dt>
<dd><p>(dataframe) column specification in the data that includes the groups (accepts either bracket or $ notation)</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>(character) string to use as title for plot</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>(character) vector of colors (as hexadecimal codes) of length &gt;= group levels (default <em>not</em> colorblind safe because of need for 10 built-in unique colors)</p></dd>


<dt id="arg-shapes">shapes<a class="anchor" aria-label="anchor" href="#arg-shapes"></a></dt>
<dd><p>(numeric) vector of shapes (as values accepted by <code>pch</code>) of length &gt;= group levels</p></dd>


<dt id="arg-lines">lines<a class="anchor" aria-label="anchor" href="#arg-lines"></a></dt>
<dd><p>(numeric) vector of line types (as integers) of length &gt;= group levels</p></dd>


<dt id="arg-pt-size">pt_size<a class="anchor" aria-label="anchor" href="#arg-pt-size"></a></dt>
<dd><p>(numeric) value for point size (controlled by character expansion i.e., <code>cex</code>)</p></dd>


<dt id="arg-pt-alpha">pt_alpha<a class="anchor" aria-label="anchor" href="#arg-pt-alpha"></a></dt>
<dd><p>(numeric) value for transparency of points (ranges from 0 to 1)</p></dd>


<dt id="arg-lab-text-size">lab_text_size<a class="anchor" aria-label="anchor" href="#arg-lab-text-size"></a></dt>
<dd><p>(numeric) value for axis label text size</p></dd>


<dt id="arg-axis-text-size">axis_text_size<a class="anchor" aria-label="anchor" href="#arg-axis-text-size"></a></dt>
<dd><p>(numeric) value for axis tick text size</p></dd>


<dt id="arg-leg-pos">leg_pos<a class="anchor" aria-label="anchor" href="#arg-leg-pos"></a></dt>
<dd><p>(character or numeric) legend position, either numeric vector of x/y coordinates or shorthand accepted by <code><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">graphics::legend</a></code></p></dd>


<dt id="arg-leg-cont">leg_cont<a class="anchor" aria-label="anchor" href="#arg-leg-cont"></a></dt>
<dd><p>(character) vector of desired legend entries. Defaults to <code>unique</code> entries in <code>groupcol</code> argument (this argument provided in case syntax of legend contents should differ from data contents)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>(plot) base R ordination with an ellipse for each group</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Use data from the vegan package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"varespec"</span>, package <span class="op">=</span> <span class="st">'vegan'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">varespec</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make some columns of known number of groups</span></span></span>
<span class="r-in"><span><span class="va">factor_4lvl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep.int</a></span><span class="op">(</span><span class="st">"Trt1"</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep.int</a></span><span class="op">(</span><span class="st">"Trt2"</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep.int</a></span><span class="op">(</span><span class="st">"Trt3"</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep.int</a></span><span class="op">(</span><span class="st">"Trt4"</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp</span><span class="op">)</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># And combine them into a single data object</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">factor_4lvl</span>, <span class="va">resp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a distance matrix from the data</span></span></span>
<span class="r-in"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu">vegan</span><span class="fu">::</span><span class="fu"><a href="https://vegandevs.github.io/vegan/reference/vegdist.html" class="external-link">vegdist</a></span><span class="op">(</span><span class="va">resp</span>, method <span class="op">=</span> <span class="st">'kulczynski'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform a PCoA on the distance matrix to get points for an ordination</span></span></span>
<span class="r-in"><span><span class="va">pnts</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/pcoa.html" class="external-link">pcoa</a></span><span class="op">(</span><span class="va">dist</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test the function for 4 groups</span></span></span>
<span class="r-in"><span><span class="fu">pcoa_ord</span><span class="op">(</span>mod <span class="op">=</span> <span class="va">pnts</span>, groupcol <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">factor_4lvl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pcoa_ord-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicholas J Lyon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

