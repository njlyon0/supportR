<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Data Wrangling • supportR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Wrangling">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">supportR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/supportr_01_wrangle.html">Data Wrangling</a></li>
    <li><a class="dropdown-item" href="../articles/supportr_02_quality-control.html">Quality Control</a></li>
    <li><a class="dropdown-item" href="../articles/supportr_03_visualizations.html">Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/supportr_04_outside-of-r.html">Operating Outside of R</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/njlyon0/supportR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Data Wrangling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/njlyon0/supportR/blob/v1.5.0/vignettes/supportr_01_wrangle.Rmd" class="external-link"><code>vignettes/supportr_01_wrangle.Rmd</code></a></small>
      <div class="d-none name"><code>supportr_01_wrangle.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>supportR</code> package is an amalgam of distinct functions
I’ve written to accomplish small data wrangling, quality control, or
visualization tasks. These functions tend to be short and
narrowly-defined. An additional consequence of the motivation for
creating them is that they tend to not be inter-related or united by a
common theme. To help account for that, I’ve divided this vignette into
groups of functions that do have similar purposes.</p>
<p>If any of these functions don’t work for you, please <a href="https://github.com/njlyon0/supportR/issues" class="external-link">open an issue</a> so
that I can repair the issue as soon as possible.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("supportR")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/njlyon0/supportR" class="external-link">supportR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>In order to demonstrate some of the data wrangling functions of
<code>supportR</code>, we’ll use some some example data from Dr. <a href="https://allisonhorst.com/allison-horst" class="external-link">Allison Horst</a>’s <a href="https://github.com/allisonhorst/palmerpenguins" class="external-link"><code>palmerpenguins</code>
R package</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check the structure of the penguins dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    344 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;  $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">#&gt;  $ bill_length_mm   : num  39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...</span></span>
<span><span class="co">#&gt;  $ bill_depth_mm    : num  18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...</span></span>
<span><span class="co">#&gt;  $ flipper_length_mm: int  181 186 195 NA 193 190 181 195 193 190 ...</span></span>
<span><span class="co">#&gt;  $ body_mass_g      : int  3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...</span></span>
<span><span class="co">#&gt;  $ sex              : Factor w/ 2 levels "female","male": 2 1 1 NA 1 2 1 2 NA NA ...</span></span>
<span><span class="co">#&gt;  $ year             : int  2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summarize-within-groups">Summarize Within Groups<a class="anchor" aria-label="anchor" href="#summarize-within-groups"></a>
</h3>
<p>With that data loaded, we can use the <code>summary_table</code>
function to quickly get group-wise summaries and retrieve generally
useful summary statistics.</p>
<p>The <code>groups</code> argument supports a vector of all of the
column names to group by while <code>response</code> must be a single
numeric column. The <code>drop_na</code> argument allows group
combinations that result in an NA to be automatically dropped (i.e., if
a penguin didn’t have an island listed that would be dropped). The mean,
standard deviation (SD), sample size, and standard error (SE) are all
returned to facilitate easy figure creation. There is also a
<code>round_digits</code> argument that lets you specify how many digits
you’d like to retain for the mean, SD, and SE.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize the data</span></span>
<span><span class="fu">supportR</span><span class="fu">::</span><span class="fu"><a href="../reference/summary_table.html">summary_table</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"island"</span><span class="op">)</span>,</span>
<span>                        response <span class="op">=</span> <span class="st">"bill_length_mm"</span>, drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;     species    island  mean std_dev sample_size std_error</span></span>
<span><span class="co">#&gt; 1    Adelie    Biscoe 38.98    2.48          44      0.37</span></span>
<span><span class="co">#&gt; 2    Adelie     Dream 38.50    2.47          56      0.33</span></span>
<span><span class="co">#&gt; 3    Adelie Torgersen 38.95    3.03          52      0.42</span></span>
<span><span class="co">#&gt; 4 Chinstrap     Dream 48.83    3.34          68      0.41</span></span>
<span><span class="co">#&gt; 5    Gentoo    Biscoe 47.50    3.08         124      0.28</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="safely-rename-columns">Safely Rename Columns<a class="anchor" aria-label="anchor" href="#safely-rename-columns"></a>
</h3>
<p>The <code>safe_rename</code> function allows–perhaps
predictably–“safe” renaming of column names in a given data object. The
‘bad’ column names and corresponding ‘good’ names must be specified. The
order of entries in the two vectors must match (i.e., the first bad name
will be replaced with the first good name), but that order need not
match the order in which they occur in the data!</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a dataframe to demonstrate</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"first"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"middle"</span> <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">6</span>, <span class="st">"second"</span> <span class="op">=</span> <span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Invoke the function</span></span>
<span><span class="fu">supportR</span><span class="fu">::</span><span class="fu"><a href="../reference/safe_rename.html">safe_rename</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, bad_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"second"</span>, <span class="st">"middle"</span><span class="op">)</span>,</span>
<span>                      good_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"third"</span>, <span class="st">"second"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   first second third</span></span>
<span><span class="co">#&gt; 1     1      4     7</span></span>
<span><span class="co">#&gt; 2     2      5     8</span></span>
<span><span class="co">#&gt; 3     3      6     9</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="handle-special-characters">Handle Special Characters<a class="anchor" aria-label="anchor" href="#handle-special-characters"></a>
</h3>
<p>When loading text data into R you may have encountered pernicious
‘special’ characters that can affect the meaning of character data.
These characters are often non-ASCII (see <a href="https://en.wikipedia.org/wiki/ASCII" class="external-link">here</a> for more context on
“ASCII” characters) and <code>supportR</code> offers the
<code>replace_non_ascii</code> function to find and replace these
characters with visually similar equivalents in a given vector.</p>
<p>Note that letters with accents above or below them (e.g., umlaut,
accent circumflex, etc.) are technically non-ASCII characters. Because
they are often a part of proper nouns rather than being categorically
incorrect I’ve split off whether they should be replaced into an
<code>include_letters</code> argument that defaults to
<code>FALSE</code>.</p>
<p>Also, non-ASCII characters trigger errors in the R package submission
process so the example below uses “u-escape” codes for ASCII characters
to still demonstrate the function without causing errors when I submit
version updates of <code>supportR</code> to CRAN.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a vector of non-ASCII characters</span></span>
<span><span class="op">(</span><span class="va">non_ascii</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\u201C"</span>, <span class="st">"\u00AC"</span>, <span class="st">"\u00D7"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "“" "¬" "×"</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Replace them with ASCII equivalents</span></span>
<span><span class="fu">supportR</span><span class="fu">::</span><span class="fu"><a href="../reference/replace_non_ascii.html">replace_non_ascii</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">non_ascii</span>, include_letters <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "\"" "-"  "x"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="crop-triangles">Crop Triangles<a class="anchor" aria-label="anchor" href="#crop-triangles"></a>
</h3>
<p><code>crop_tri</code> allows dropping one “triangle” of a symmetric
dataframe / matrix. It also includes a <code>drop_diag</code> argument
that accepts a logical for whether to drop the diagonal of the data
object. This is primarily useful (I find) in allowing piping through
this function as opposed to using the base R notation for removing a
triangle of a symmetric data object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a simple matrix wtih symmetric dimensions</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Crop off it's lower triangle</span></span>
<span><span class="fu">supportR</span><span class="fu">::</span><span class="fu"><a href="../reference/crop_tri.html">crop_tri</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mat</span>, drop_tri <span class="op">=</span> <span class="st">"lower"</span>, drop_diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]    1    2</span></span>
<span><span class="co">#&gt; [2,]   NA    1</span></span>
<span></span>
<span><span class="co"># Drop the diagonal as well</span></span>
<span><span class="fu">supportR</span><span class="fu">::</span><span class="fu"><a href="../reference/crop_tri.html">crop_tri</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mat</span>, drop_tri <span class="op">=</span> <span class="st">"lower"</span>, drop_diag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]   NA    2</span></span>
<span><span class="co">#&gt; [2,]   NA   NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="melt-arrays-into-dataframes">“Melt” Arrays into Dataframes<a class="anchor" aria-label="anchor" href="#melt-arrays-into-dataframes"></a>
</h3>
<p><code>array_melt</code> allows users to ‘melt’ an array of dimensions
X, Y, and Z into a dataframe containing columns “x”, “y”, “z”, and
“value” where “value” is whatever was stored at those coordinates in the
array.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make data to fill the array</span></span>
<span><span class="va">vec1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">9</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">vec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create dimension names (x = col, y = row, z = which matrix)</span></span>
<span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Col_1"</span>,<span class="st">"Col_2"</span>,<span class="st">"Col_3"</span><span class="op">)</span></span>
<span><span class="va">y_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Row_1"</span>,<span class="st">"Row_2"</span>,<span class="st">"Row_3"</span><span class="op">)</span></span>
<span><span class="va">z_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mat_1"</span>,<span class="st">"Mat_2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make an array from these components</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>, <span class="va">vec2</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>           dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="va">y_vals</span>, <span class="va">z_vals</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># "Melt" the array into a dataframe</span></span>
<span><span class="va">melted</span> <span class="op">&lt;-</span> <span class="fu">supportR</span><span class="fu">::</span><span class="fu"><a href="../reference/array_melt.html">array_melt</a></span><span class="op">(</span>array <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at that top of that</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">melted</span><span class="op">)</span></span>
<span><span class="co">#&gt;       z     y     x value</span></span>
<span><span class="co">#&gt; 1 Mat_1 Col_1 Row_1     5</span></span>
<span><span class="co">#&gt; 2 Mat_1 Col_1 Row_2    10</span></span>
<span><span class="co">#&gt; 3 Mat_1 Col_1 Row_3    13</span></span>
<span><span class="co">#&gt; 4 Mat_1 Col_2 Row_1     9</span></span>
<span><span class="co">#&gt; 5 Mat_1 Col_2 Row_2    11</span></span>
<span><span class="co">#&gt; 6 Mat_1 Col_2 Row_3    14</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicholas J Lyon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
